<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Jetpack on stsnãƒ–ãƒ­ã‚°</title>
    <link>https://satoshun.github.io/tags/jetpack/</link>
    <description>Recent content in Jetpack on stsnãƒ–ãƒ­ã‚°</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <copyright>Sato Shun</copyright>
    <lastBuildDate>Sun, 14 Oct 2018 00:00:00 +0000</lastBuildDate>
    
	<atom:link href="https://satoshun.github.io/tags/jetpack/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Unitãƒ†ã‚¹ãƒˆã§ViewModelã®onClearedã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹</title>
      <link>https://satoshun.github.io/2018/10/unittest-viewodel_oncleared/</link>
      <pubDate>Sun, 14 Oct 2018 00:00:00 +0000</pubDate>
      
      <guid>https://satoshun.github.io/2018/10/unittest-viewodel_oncleared/</guid>
      <description> ãµã¨AACã®ViewModelã®onClearedãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒ†ã‚¹ãƒˆã—ãŸããªã£ãŸã®ã§ã€ 2ã¤ã®ã‚„ã‚Šã‹ãŸã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
ç’°å¢ƒã¯
&amp;quot;junit:junit:4.12&amp;quot; &amp;quot;androidx.test:rules:1.1.0-beta02&amp;quot; &amp;quot;androidx.test:runner:1.1.0-beta02&amp;quot; &amp;quot;androidx.test.ext:junit:1.0.0-beta02&amp;quot; &amp;quot;com.nhaarman:mockito-kotlin-kt1.1:1.5.0&amp;quot; &amp;quot;org.robolectric:robolectric:4.0-beta-1&amp;quot;  ã«ãªã‚Šã¾ã™ã€‚
ã¾ãŸã€ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ GitHubã«ã‚ã‚‹ã®ã§ã€å‚è€ƒã—ã¦ãã ã•ã„ğŸ˜Š
1. ViewModelStoreã‚’ä½¿ã† ViewModelProviders.of(activity).get(class)ã‹ã‚‰ViewModelã‚’å–å¾—ã—ãŸã¨ãã«ã€å–å¾—ã—ãŸViewModelã¯ViewModelStoreã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã¾ã™ã€‚ã“ã®ViewModelStoreã¯FragmentActivityã‹ã‚‰å–å¾—ã§ãã‚‹ã®ã§ã€æ¬¡ã®ã‚ˆã†ã«æ›¸ãã“ã¨ã§ViewModelã®onClearedã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚
@RunWith(AndroidJUnit4::class) class BaseViewModelTest { @get:Rule val activityRule = ActivityTestRule(FragmentActivity::class.java) @Test fun `dispose a coroutine when finished lifecycle of ViewModel`() { activityRule.activity.viewModelStore.clear() // ViewModelãŒé–‹æ”¾ã•ã‚Œã‚‹ } }  ã“ã®ãƒ†ã‚¹ãƒˆã¯ã‚³ãƒ¼ãƒ‰çš„ã«ã¯ç°¡å˜ã§ã™ãŒã€ViewModelStoreãŒViewModelã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’ç®¡ç†ã—ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹ã€å†…éƒ¨å®Ÿè£…ã®è©³ç´°ã¾ã§çŸ¥ã£ã¦ã„ã‚‹ãŸã‚ã€ãƒ†ã‚¹ãƒˆã¨ã—ã¦ãµã•ã‚ã—ããªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
ãªã®ã§ã€ç´ ç›´ã«onDestroyã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚‚æ›¸ã„ã¦ã¿ã¾ã™ã€‚
2. Instrumentation.callActivityOnDestroyã‚’ä½¿ã† Instrumentationã‚¯ãƒ©ã‚¹ã‚’ä½¿ã†ã“ã¨ã§Activityã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚ Instrumentationã¯InstrumentationRegistryã‚¯ãƒ©ã‚¹ã‹ã‚‰å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã€æ¬¡ã®ã‚ˆã†ã«æ›¸ãã“ã¨ã§ã€onDestroyã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
@Test fun `dispose a coroutine when finished lifecycle of ViewModel 2`() { // onDestroyãŒã‚³ãƒ¼ãƒ«ã•ã‚ŒViewModelãŒé–‹æ”¾ã•ã‚Œã‚‹ InstrumentationRegistry.getInstrumentation().callActivityOnDestroy(activityRule.activity) }  ã“ã‚Œã§ã€Unitãƒ†ã‚¹ãƒˆã§ViewModel.onClearedã®ãƒ†ã‚¹ãƒˆã‚’ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚
ä»¥ä¸Šã§ã™ã€‚Happy Testingâ˜†å½¡
 ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰  </description>
    </item>
    
    <item>
      <title>Android: Navigationã®safeargs Gradle pluginã ã‘ã‚’ä½¿ã£ã¦ã‚‚ã„ã„ã‹ã‚‚ã—ã‚Œãªã„</title>
      <link>https://satoshun.github.io/2018/05/navigation-only_use_safe_args/</link>
      <pubDate>Sun, 20 May 2018 00:00:00 +0000</pubDate>
      
      <guid>https://satoshun.github.io/2018/05/navigation-only_use_safe_args/</guid>
      <description>Google I/O 2018ã§JetpackãŒç™»å ´ã—ã€æ–°ãŸã«Navigationãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå°å…¥ã•ã‚Œã¾ã—ãŸã€‚ ã–ã£ãã‚Šã¨èª¬æ˜ã™ã‚‹ã¨ã€ç”»é¢ã®é·ç§»ã®å®Ÿè£…ã‚’åŠ©ã‘ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãªã£ã¦ã„ã¾ã™ã€‚å®Ÿè£…çš„ã«ã¯ã€FragmentTransactionã‚’ç›´æ¥ã„ã˜ã‚‹ã“ã¨ãŒãªããªã‚‹ã¨ã„ã£ãŸãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚
ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ©Ÿèƒ½ã«ã€safeargsã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚ŒãŒä¾¿åˆ©ã§ã€æœ€åˆã¯ã“ã®æ©Ÿèƒ½ã ã‘ã‚’ä½¿ã†ã®ã‚‚ã„ã„ã®ã§ã¯? ã¨æ€ã£ã¦ã„ã‚‹ã®ã§ãã®ç´¹ä»‹ã§ã™ã€‚
safeargsã‚’ä½¿ã£ã¦ã¿ã‚‹ ä¸€èˆ¬çš„ã«Fragmentã«é©å½“ãªå€¤ã‚’æ¸¡ã™ã¨ãã¯Bundleã‚’é€šã—ã¦æ¸¡ã—ã¾ã™ã€‚
// å‘¼ã³å‡ºã—å´ val bundle = Bundle() bundle.putInt(&amp;quot;step&amp;quot;, 10) // å‘¼ã³å‡ºã•ã‚Œå´ val step = arguments?.getInt(&amp;quot;step&amp;quot;)  ã“ã‚Œã®å•é¡Œç‚¹ã¨ã—ã¦ã¯ã€typesafeã§ç„¡ã„ã¨ã“ã‚ã§ã™ã€‚ä¾‹ãˆã°ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãªã©ã§ã€ç‰‡æ–¹ã®æ–‡å­—åˆ—ã‚’&amp;quot;step2&amp;quot;ã«ã—ã¦ã—ã¾ã†ã¨ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
ã“ã‚Œã‚’è§£æ±ºã«ã™ã‚‹ãŸã‚ã«Navigationã§ã¯safe argsã¨ã„ã†æ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ ã“ã‚Œã¯ã€DataBindingã®ã‚ˆã†ã«ã€ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã§typesafeã‚’å®Ÿç¾ã—ã¾ã™ã€‚
&amp;lt;navigation xmlns:android=&amp;quot;http://schemas.android.com/apk/res/android&amp;quot; xmlns:app=&amp;quot;http://schemas.android.com/apk/res-auto&amp;quot; xmlns:tools=&amp;quot;http://schemas.android.com/tools&amp;quot;&amp;gt; &amp;lt;fragment android:name=&amp;quot;com.example.android.codelabs.navigation.HogeFragment&amp;quot; android:label=&amp;quot;Hoge&amp;quot;&amp;gt; &amp;lt;argument android:name=&amp;quot;step&amp;quot; app:type=&amp;quot;integer&amp;quot; android:defaultValue=&amp;quot;1&amp;quot;/&amp;gt; &amp;lt;/fragment&amp;gt; &amp;lt;/navigation&amp;gt;  ã¨navigationã‚’è¨˜è¿°ã™ã‚‹ã¨ã€
public class HogeFragmentArgs { private int step = 1; private HogeFragmentArgs() { } public static HogeFragmentArgs fromBundle(Bundle bundle) { HogeFragmentArgs result = new HogeFragmentArgs(); if (bundle.containsKey(&amp;quot;step&amp;quot;)) { result.</description>
    </item>
    
    <item>
      <title>Android: æ‹¡å¼µé–¢æ•°ã§LiveDataã®Single Eventã‚’æ‰±ã†</title>
      <link>https://satoshun.github.io/2018/05/singlelivedata/</link>
      <pubDate>Sat, 19 May 2018 00:00:00 +0000</pubDate>
      
      <guid>https://satoshun.github.io/2018/05/singlelivedata/</guid>
      <description>LiveDataã¯æœ€æ–°ã®å€¤ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ãŸã‚ã€ã‚¨ãƒ©ãƒ¼å€¤ã®å–æ‰±ãªã©ã«å›°ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ é©å½“ãªã‚¯ãƒ©ã‚¹ã‚’ä½œã‚‹ã®ã‚‚ã„ã„ã®ã§ã™ãŒã€æ‹¡å¼µé–¢æ•°ã§è¡¨ç¾ã™ã‚‹ã“ã¨ã‚‚å‡ºæ¥ã‚‹ã®ã§ãã®ç´¹ä»‹ã§ã™ã€‚
å®šç¾©ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
fun &amp;lt;T&amp;gt; singleLiveData(): MutableLiveData&amp;lt;T&amp;gt; { // skipç”¨ã®åˆæœŸå€¤ã‚’å…¥ã‚Œã¦ãŠã return MutableLiveData&amp;lt;T&amp;gt;().also { it.value = null } } fun &amp;lt;T&amp;gt; LiveData&amp;lt;T&amp;gt;.observeSingle(owner: LifecycleOwner, observer: ((T?) -&amp;gt; Unit)) { // æœ€åˆã®å€¤ã¯å¸¸ã«skipã™ã‚‹ã“ã¨ã§ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡è¦–ã™ã‚‹ val firstIgnore = AtomicBoolean(true) this.observe(owner, Observer { if (firstIgnore.getAndSet(false)) return@Observer observer(it) }) }  ä½¿ã†æ™‚ã¯ã“ã‚“ãªæ„Ÿã˜ã§ä½¿ã„ã¾ã™ã€‚
// TestViewModel.kt class TestViewModel: ViewModel() { val errorEvent = singleLiveData&amp;lt;String&amp;gt;() } // TestActivity.kt testViewModel = ViewModelProviders.of(this).get(TestViewModel::class.java) testViewModel.errorEvent.observeSingle(activity) { Log.d(&amp;quot;one&amp;quot;, it.toString()) }  ãƒ¡ãƒªãƒƒãƒˆã¯ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‚’ä½œã‚‰ãšã«æ¸ˆã‚€ã¨ã“ã‚ã§ã™ã€‚
å‚è€ƒ  https://github.</description>
    </item>
    
  </channel>
</rss>